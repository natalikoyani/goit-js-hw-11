{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,0BAKA,MAAMC,EAAaC,SAASC,cAAc,gBACpCC,EAAUF,SAASC,cAAc,YACjCE,EAAiBH,SAASC,cAAc,cAK9C,IAAIG,EAAO,EAGPC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAAEC,aAAc,MAiDhEC,eAAeC,EAAYC,GACvB,MAAMC,EAAe,IAAIC,gBAAgB,CACrCC,IAxDQ,qCAyDRH,EAAGA,EACHI,WAAY,QACZC,YAAa,aACbC,YAAY,EACZC,SA1DO,GA2DPC,KAAMf,IAGV,aADuBP,EAAAuB,QAAMC,IAAI,4BAAeT,MAChCU,I,CAGpB,SAASC,EAAaC,GAClB,OAAOA,EACNC,KACG,EAACC,cAAEA,EAAaC,aAAEA,EAAYC,KAAEA,EAAIC,MAAEA,EAAKC,MAAEA,EAAKC,SAAEA,EAAQC,UAAEA,KAAgB,8CACnEN,gBAA4BC,WAAsBC,sIAGtBC,+GAGAC,kHAGGC,mHAGCC,+DAK9CC,KAAK,G,CAGV,SAASC,IACP,MAAQC,OAAQC,GAAepC,SAC9BC,cAAc,YACdoC,kBAAkBC,wBAErBC,OAAOC,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CA5FZ3C,EAAW4C,iBAAiB,UAG5BlC,eAA4BmC,GACxBA,EAAIC,iBACJ3C,EAAQ4C,UAAY,GACpB3C,EAAe4C,UAAUC,IAAI,aAC7B5C,EAAO,EACP,MAAMO,EAAIZ,EAAWkD,SAASC,YAAYC,MAAMC,OAAOC,WAAW,IAAK,KAAKD,OAE5E,IACE,MAAM9B,QAAaZ,EAAYC,GACN,IAArBW,EAAKgC,KAAKC,OACZC,EAAAC,OAAOC,QAAQ,4EACD,KAAN/C,EACR6C,EAAAC,OAAOC,QAAQ,iCAEfF,EAAAC,OAAOE,KAAK,oBAAoBrC,EAAKsC,qBACrC1D,EAAQ4C,UAAYvB,EAAaD,EAAKgC,MACtCjD,EAASwD,UACT3B,IACA/B,EAAe4C,UAAUe,OAAO,a,CAElC,MAAMC,GACNC,QAAQC,MAAMF,GACdP,EAAAC,OAAOC,QAAQ,mE,KAxBrBvD,EAAewC,iBAAiB,SA4BhClC,iBACEL,GAAQ,EACR,MAAMO,EAAIZ,EAAWkD,SAASC,YAAYC,MAAME,WAAW,IAAK,KAChE,IACE,MAAM/B,QAAaZ,EAAYC,GACzBuD,EAAaC,KAAKC,KAAK9C,EAAKsC,UAtCvB,IAuCX1D,EAAQmE,mBAAmB,YAAa9C,EAAaD,EAAKgC,OAC1DpB,IACO9B,GAAQ8D,IACT/D,EAAe4C,UAAUC,IAAI,aAC7BQ,EAAAC,OAAOE,KAAK,8D,CAElB,MAAOI,GACPC,QAAQC,MAAMF,GACdP,EAAAC,OAAOC,QAAQ,wE","sources":["src/js/load_more_button.js"],"sourcesContent":["import axios from \"axios\";\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '39228988-9f38d0df7f0bcbddd9d36da69';\n\nlet page = 1;\nlet per_page = 40;\n\nlet lightbox = new SimpleLightbox('.gallery a', { captionDelay: 250, });\n\nsearchForm.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', handleClick);\n\nasync function handleSubmit(evt) {\n    evt.preventDefault();\n    gallery.innerHTML = '';\n    loadMoreButton.classList.add('is-hidden');\n    page = 1;\n    const q = searchForm.elements.searchQuery.value.trim().replaceAll(' ', '+').trim();\n    \n    try {\n      const data = await fetchImages(q);\n      if (data.hits.length === 0) {\n        Notify.failure(\"Sorry, there are no images matching your search query. Please try again.\");\n      } else if(q === '') {\n        Notify.failure(\"Search field can't be empty!\");\n      } else {\n        Notify.info(`Hooray! We found ${data.totalHits} images.`)\n        gallery.innerHTML = createMarkup(data.hits);\n        lightbox.refresh();\n        smoothScroll();\n        loadMoreButton.classList.remove('is-hidden');\n      }\n    } catch(err) {\n      console.error(err);\n      Notify.failure(\"An error occurred while fetching images. Please try again later.\");\n    }\n}\n\nasync function handleClick() {\n  page += 1;\n  const q = searchForm.elements.searchQuery.value.replaceAll(' ', '+');\n  try {\n    const data = await fetchImages(q);\n    const totalPages = Math.ceil(data.totalHits / per_page);\n    gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    smoothScroll();\n        if(page >= totalPages) {\n          loadMoreButton.classList.add('is-hidden');\n          Notify.info(\"We're sorry, but you've reached the end of search results.\");\n        }\n  } catch (err) {\n    console.error(err);\n    Notify.failure(\"An error occurred while fetching more images. Please try again later.\");\n  }\n}\n\nasync function fetchImages(q) {\n    const searchParams = new URLSearchParams({\n        key: API_KEY,\n        q: q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: per_page,\n        page: page,\n    });\n    const response = await axios.get(`${BASE_URL}?${searchParams}`);\n    return response.data;\n}\n\nfunction createMarkup(arr) {\n    return arr\n    .map(\n        ({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/></a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes <span class=\"info-span\">${likes}</span></b>\n          </p>\n          <p class=\"info-item\">\n            <b>Views <span class=\"info-span\">${views}</span></b>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments <span class=\"info-span\">${comments}</span></b>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads <span class=\"info-span\">${downloads}</span></b>\n          </p>\n        </div>\n      </div>`\n    )\n    .join('');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n  .querySelector(\".gallery\")\n  .firstElementChild.getBoundingClientRect();\n\nwindow.scrollBy({\n  top: cardHeight * 2,\n  behavior: \"smooth\",\n});\n}"],"names":["$2shzp","parcelRequire","$2699a45736ec2f06$var$searchForm","document","querySelector","$2699a45736ec2f06$var$gallery","$2699a45736ec2f06$var$loadMoreButton","$2699a45736ec2f06$var$page","$2699a45736ec2f06$var$lightbox","$parcel$interopDefault","$fZKcF","captionDelay","async","$2699a45736ec2f06$var$fetchImages","q","searchParams","URLSearchParams","key","image_type","orientation","safesearch","per_page","page","default","get","data","$2699a45736ec2f06$var$createMarkup","arr","map","largeImageURL","webformatURL","tags","likes","views","comments","downloads","join","$2699a45736ec2f06$var$smoothScroll","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","addEventListener","evt","preventDefault","innerHTML","classList","add","elements","searchQuery","value","trim","replaceAll","hits","length","$iQIUW","Notify","failure","info","totalHits","refresh","remove","err","console","error","totalPages","Math","ceil","insertAdjacentHTML"],"version":3,"file":"load_more_button.9106a0dd.js.map"}