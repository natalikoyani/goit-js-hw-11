{"mappings":"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","sources":["src/js/load_more_button.js"],"sourcesContent":["import axios from \"axios\";\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '39228988-9f38d0df7f0bcbddd9d36da69';\n\nlet page = 1;\nlet per_page = 40;\n\nlet lightbox = new SimpleLightbox('.gallery a', { captionDelay: 250, });\n\nsearchForm.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', handleClick);\n\nasync function handleSubmit(evt) {\n    evt.preventDefault();\n    gallery.innerHTML = '';\n    loadMoreButton.classList.add('is-hidden');\n    page = 1;\n    const q = searchForm.elements.searchQuery.value.trim().replaceAll(' ', '+').trim();\n    \n    try {\n      const data = await fetchImages(q);\n      if (data.hits.length === 0) {\n        Notify.failure(\"Sorry, there are no images matching your search query. Please try again.\");\n      } else if(q === '') {\n        Notify.failure(\"Search field can't be empty!\");\n      } else {\n        Notify.info(`Hooray! We found ${data.totalHits} images.`)\n        gallery.innerHTML = createMarkup(data.hits);\n        lightbox.refresh();\n        smoothScroll();\n        loadMoreButton.classList.remove('is-hidden');\n      }\n    } catch(err) {\n      console.error(err);\n      Notify.failure(\"An error occurred while fetching images. Please try again later.\");\n    }\n}\n\nasync function handleClick() {\n  page += 1;\n  const q = searchForm.elements.searchQuery.value.replaceAll(' ', '+');\n  try {\n    const data = await fetchImages(q);\n    const totalPages = Math.ceil(data.totalHits / per_page);\n    gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    smoothScroll();\n        if(page >= totalPages) {\n          loadMoreButton.classList.add('is-hidden');\n          Notify.info(\"We're sorry, but you've reached the end of search results.\");\n        }\n  } catch (err) {\n    console.error(err);\n    Notify.failure(\"An error occurred while fetching more images. Please try again later.\");\n  }\n}\n\nasync function fetchImages(q) {\n    const searchParams = new URLSearchParams({\n        key: API_KEY,\n        q: q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: per_page,\n        page: page,\n    });\n    const response = await axios.get(`${BASE_URL}?${searchParams}`);\n    return response.data;\n}\n\nfunction createMarkup(arr) {\n    return arr\n    .map(\n        ({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/></a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes <span class=\"info-span\">${likes}</span></b>\n          </p>\n          <p class=\"info-item\">\n            <b>Views <span class=\"info-span\">${views}</span></b>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments <span class=\"info-span\">${comments}</span></b>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads <span class=\"info-span\">${downloads}</span></b>\n          </p>\n        </div>\n      </div>`\n    )\n    .join('');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n  .querySelector(\".gallery\")\n  .firstElementChild.getBoundingClientRect();\n\nwindow.scrollBy({\n  top: cardHeight * 2,\n  behavior: \"smooth\",\n});\n}"],"names":["$bpxeT","parcelRequire","$cb8c4ea6a37978f6$var$searchForm","document","querySelector","$cb8c4ea6a37978f6$var$gallery","$cb8c4ea6a37978f6$var$loadMoreButton","$cb8c4ea6a37978f6$var$BASE_URL","$cb8c4ea6a37978f6$var$API_KEY","$cb8c4ea6a37978f6$var$page","$cb8c4ea6a37978f6$var$lightbox","$parcel$interopDefault","$5IjG7","captionDelay","$cb8c4ea6a37978f6$var$_handleSubmit","$2TvXO","mark","_callee","evt","q","data","preventDefault","innerHTML","classList","add","elements","searchQuery","value","trim","replaceAll","$cb8c4ea6a37978f6$var$fetchImages","_ctx","sent","hits","length","$h6c0i","Notify","failure","info","concat","totalHits","$cb8c4ea6a37978f6$var$createMarkup","refresh","$cb8c4ea6a37978f6$var$smoothScroll","remove","console","error","t0","apply","this","arguments","$cb8c4ea6a37978f6$var$_handleClick","totalPages","Math","ceil","insertAdjacentHTML","$cb8c4ea6a37978f6$var$_fetchImages","searchParams","response","URLSearchParams","key","image_type","orientation","safesearch","per_page","page","$dIxxU","default","get","arr","map","param","largeImageURL","webformatURL","tags","likes","views","comments","downloads","join","cardHeight","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior","addEventListener"],"version":3,"file":"load_more_button.b1c1af59.js.map"}